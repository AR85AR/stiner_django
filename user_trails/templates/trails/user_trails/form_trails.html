{% extends 'base_trail.html' %}
{% load static %}
{% block content %}
<div class="wrap-trails_add">
        <div class="title-trail_add">
            <h3>Stwórz trasę</h3>
        </div>

    {% if len_user %}
    <div class="opacity" style=" height: 50px; width: 50px; position: absolute; right: 160px; top:320px" >
        <a href="{% url "user_trails:user_trail_draft"%}"><img src="{% static 'img/map_draft.png' %}" alt="" style="height: 50px; width: 50px;"> <span style="position: absolute; right: 21px; top:15px; font-size: 24px; font-weight: bold; color: #565656">{{len_user}}</span></a>
    </div>
        {%else%}
    <div class="opacity" style=" height: 50px; width: 50px; position: absolute; right: 140px;top:320px" >
        <img src="{% static 'img/map_draft.png' %}" alt="" style="height: 50px; width: 50px;position: relative; right: 20px">
          </div>
        {% endif %}

        <div class="trail_add-center">
             <div class="filter_trails">
                <h3> Filtrowanie tras: </h3>
                <div class="filter">
                        <form action="" method="post" >
                            <div class="name">
                                <label>Nazwa:</label>
                                <input type="text" name="name" placeholder="Wyszukaj trasę po nazwie">
                            </div>
                            <div class="country">
                                <label>Kraj:</label>
                                    {% for c in country %}
                                        <label><input type="checkbox" name="country" value="{{ c }}">{{ c }}</label>
                                    {% endfor %}
                                <p>Pokaż więcej</p>
                            </div>
                            <div class="region">
                                <label>Region:</label>

                                {% for r in region %}
                                    <label><input type="checkbox" name="region" value="{{ r }}">{{ r }}</label>
                                {% endfor %}

                                <p>Pokaż więcej</p>
                            </div>
                            <div class="city">
                                <label>Miasto:</label>
                                    {% for i in city %}
                                            <label><input type="checkbox" name="city" value="{{ i }}">{{i}}</label>
                                    {% endfor %}
                                <p class="city">Pokaż więcej</p>
                            </div>
                            <div class="accept_filter"><button id="button-filter_your-trail">ZASTOSUJ FILTRY</button></div>
                            {% csrf_token %}
                        </form>
                </div>
            </div>



              <div class="przyklad">
                    <div class="points_add_to_user_trail" id="points_add_to_user_trail">
                         {% for element in list %}
                            <div class="point_add {{element.name}}">
                                <div class="image">
                                    <img src=" {{element.image.url}}" alt="image_point" class="point_add_image">
                                    </div>
                                <p>{{element.name}}</p>
                                <div class="buttons">
                                <a href="{% url "user_trails:detail_point" element.id %}"><input type="submit" value="Szczegóły" class="add_to_user_trail"></a>
                                <form action="" method="GET" >{% csrf_token %}<input hidden name="add_point" type="text" value='{{element.name}}'><button class="add" >Dodaj</button></form>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                    <button id="left"><</button>
                    <button id="right">></button>

                            {{zmienna}}
                        </div>
                    </div>

            {{ list_point }}
        </div>
    </div>

<script>

        //    Obsługa przycisku Pokaż więcej
let more = document.querySelector('p.city');
let div_city = document.querySelector('div.city')

more.addEventListener('click', function () {
    div_city.classList.toggle("active");

})

//      Sekcja stwórz trasę, obsługa strzałek
    let buttonRight = document.getElementById('right');
    let buttonLeft = document.getElementById('left');
     let amount = document.querySelectorAll('div.point_add');
     let position = 0;
    buttonRight.addEventListener('click', function () {
        let list_point_user_add = document.getElementById('points_add_to_user_trail');
        if(position>=0 && position<= amount.length *350){
            position += 350;
            list_point_user_add.style.marginLeft =`-${position}px`
        }
    });
    buttonLeft.addEventListener('click', function () {
        let list_point_user_add = document.getElementById('points_add_to_user_trail');
        if (position>=350){
            position -= 350;
            list_point_user_add.style.marginLeft =`-${position}px`
        }
    });

const button = document.getElementById('button-filter_your-trail')

    window.addEventListener(
        'scroll',
        () => {
            if (window.scrollY >= 175) {
            button.style.position = 'static'
        }else {
            button.style.position = 'fixed'
        }
    }
    )
</script>
{% endblock %}
